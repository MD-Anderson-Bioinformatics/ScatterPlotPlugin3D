<!DOCTYPE html>
<html>
	<head>
		<title>threejs</title>
		<meta charset='utf-8'/>
		<link rel='stylesheet' href='./css/main.css'>
		<script src="resources/three.min.js"></script>
		<script src="resources/OrbitControls.js"></script>
		<script src="demo_js/d3.v5.min.js"></script> <!-- only using d3 to load a local file and resolve promise when loaded -->
		<script src="demo_js/threex.rendererstats.js"></script>  <!-- only using threex for profiling in demo plot -->
		<script type="module" src="./scatterPlot3D.js"></script>
		<script type="module" src="js/selections.js"></script>
		<script type='module'>
			import {Plot3D} from './scatterPlot3D.js';
			import {SelectPoints} from './js/selections.js';
			import Stats from './demo_js/stats.module.js'; // only using stats module for profiling demo plot
			document.addEventListener("DOMContentLoaded", function(event) {
				d3.tsv('demo_data/data.tsv').then(function(data) {
					const plotOptions = {
						pointSize: 0.1,
						xLabel: 'x-axis',
						yLabel: 'y-axis',
						zLabel: 'z-axis',
						plotTitle: 'Demonstration',
						legendTitle: 'i am legend',
						backgroundColor: 'ivory',
						showOriginAxes: true
					}
					Plot3D.createPlot(data, plotOptions);
					function redraw() {
						let elem = document.getElementById('showOriginAxes')
						plotOptions.showOriginAxes = elem.options[elem.selectedIndex].value;
						elem = document.getElementById('x-axis-label')
						plotOptions.xLabel = elem.options[elem.selectedIndex].value;
						plotOptions.yLabel = 'Y'
						plotOptions.zLabel = 'Z'
						Plot3D.createPlot(data, plotOptions);
					}
					window.redraw = redraw;
					})
				function addSpheres() {
					let pointsList = ['Sitdolorevelit.-7','Sitdolorevelit.-2']
					SelectPoints.selectPoints(pointsList);
				}
				window.addSpheres = addSpheres;
				function removeSpheres() {
					SelectPoints.clearSelectedPoints();
				}
				window.removeSpheres = removeSpheres;
			})
			// using the stats module from https://threejs.org/examples/misc_boxselection.html
			var stats = new Stats()
			document.body.appendChild(stats.dom)
			// Just here for debugging
			// see: http://learningthreejs.com/blog/2013/06/25/monitor-rendering-performance-within-threejs/
			var rendererStats  = new THREEx.RendererStats()
			rendererStats.domElement.style.position   = 'absolute'
			rendererStats.domElement.style.left  = '0px'
			rendererStats.domElement.style.bottom    = '0px'
			document.body.appendChild( rendererStats.domElement )
			 // marohrdanz: for the demo-only, animate every frame
			 // for the main index.html page, only rendering when things change)
			var animate = function() {
				window.animationID = requestAnimationFrame(animate);
				if (Plot3D.controls) Plot3D.controls.update()
				if (Plot3D.camera) {
					Plot3D.renderer.render(Plot3D.scene, Plot3D.camera) 
				}
				rendererStats.update(Plot3D.renderer);
				stats.update()
			}
			animate()
		</script>
	</head>
	<body>
		<div id="icons-div">
			<img src='img/zoom-pan.png' id='orbit-controls-icon' class='icon' style='visibility:hidden;'>
			<img src='img/drag-to-select.png' id='drag-to-select-icon' class='icon' style='visibility:hidden;'>
		</div>
		<div id='name-coords-div'>
				<p id='point-name'></p>
				<p id='show-hover-point-coords'></p>
		</div>
		<canvas id='scatter-plot-3d-canvas' style='visibility:hidden;'></canvas>
	</body>

</html>
